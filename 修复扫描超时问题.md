# 修复扫描超时问题

## 问题

添加 `--config=p/security-audit` 配置后，Semgrep扫描超时（超过300秒），导致返回0个结果。

## 原因

1. **security-audit配置包含大量规则**：扫描时间会显著增加
2. **项目文件很多**：从日志看，项目解压后有8955个文件，扫描量大
3. **超时时间太短**：原来设置的300秒不够

## 解决方案

### 方案1：使用auto配置（推荐，已修复）

- 保持使用 `--config=auto`（默认配置）
- 增加超时时间到600秒（10分钟）
- 优点：扫描速度快，能检测常见安全问题
- 缺点：可能遗漏一些深层次的安全问题

### 方案2：使用security-audit但增加超时（可选）

如果需要更严格的安全扫描，可以：
1. 将超时时间增加到1200秒（20分钟）或更长
2. 排除不必要的目录（node_modules、vendor、target等）
3. 限制扫描的文件大小

### 方案3：优化扫描配置（可选）

可以添加排除目录选项：

```python
cmd = [
    'semgrep', '--json', '--config=auto',
    '--exclude', 'node_modules',
    '--exclude', 'vendor',
    '--exclude', 'target',
    '--exclude', '.git',
    project_path
]
```

## 已修复内容

1. ✅ 移除 `--config=p/security-audit`（太慢）
2. ✅ 增加超时时间从300秒到600秒
3. ✅ 改进超时错误提示信息

## 测试

重新创建一个SAST扫描任务，应该能够：
- 在600秒内完成扫描
- 返回扫描结果（不再是0个）

## 如果还是超时

如果项目文件特别多（超过10000个文件），可能需要：
1. 进一步增加超时时间（如1200秒）
2. 添加排除目录选项
3. 考虑分批扫描

