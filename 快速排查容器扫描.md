# 快速排查容器扫描失败

## 步骤1：查看完整后端日志（不筛选）

```bash
cd ~/projects/anquansaomiao
docker-compose logs --tail=200 backend
```

这会显示所有日志，包括：
- `[ScannerService]` - 扫描服务日志
- `[Container]` - 容器扫描器日志
- Python异常和错误

## 步骤2：检查代码是否已更新

```bash
# 进入容器检查代码
docker-compose exec backend head -10 /app/app/scanners/container_scanner.py
```

应该看到 `import sys` 和最新的代码。

## 步骤3：强制重启后端

```bash
docker-compose restart backend
sleep 10
docker-compose logs --tail=50 backend
```

## 步骤4：重新创建扫描任务并实时查看日志

```bash
# 在一个终端窗口实时查看日志
docker-compose logs -f backend

# 在另一个终端或浏览器中创建新的容器扫描任务
# 配置：{"image_name": "nginx:latest"}
```

## 步骤5：如果还是没有日志，检查扫描任务是否执行

```bash
# 查看所有扫描相关的日志
docker-compose logs --tail=500 backend | grep -E "扫描|scan|ScannerService"
```

## 常见问题

1. **代码未更新**：需要重启后端容器
2. **扫描任务未启动**：后台线程可能没有执行
3. **异常被捕获**：查看是否有 `[ScannerService] 扫描执行失败` 的日志

