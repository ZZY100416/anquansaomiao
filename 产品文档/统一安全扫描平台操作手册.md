# 统一安全扫描平台操作手册

> 面向日常使用平台的安全工程师、开发人员，讲解如何完成项目管理、扫描任务、结果分析及 RASP 事件查看。

## 1. 登录与角色

- 首次部署后，由管理员创建账号并分配角色（当前版本默认管理员权限）。
- 登录地址：`http://<服务器IP>:3000`
- 建议登录后立即修改密码，并开启浏览器保存凭证。

## 2. 快速上手流程

1. 登录平台 → 创建项目
2. 上传源码/压缩包 → 平台识别项目类型
3. 创建扫描任务（SAST/SCA/容器/RASP）
4. 查看任务列表与结果详情
5. 持续关注仪表盘与 RASP 攻击事件

## 3. 项目管理

### 3.1 创建项目

1. 进入“项目管理” → “新建项目”
2. 填写项目名称、描述、仓库地址（可选）
3. 保存后，项目出现在列表中

### 3.2 上传代码

- 在项目详情页点击“上传文件”
- 支持 ZIP 或源码目录（压缩包推荐）
- 上传后页面显示“文件状态：已上传”
- 服务器存储路径：`backend/uploaded_files/project_{id}/`

> 若状态仍显示“未上传”，可刷新页面或检查网络；问题已在最新版本修复。

## 4. 扫描任务管理

### 4.1 创建任务

1. 在项目详情中点击“新建扫描任务”
2. 选择扫描类型：SAST、SCA、容器、RASP
3. 可选配置：在“扫描配置（JSON）”中填写参数，例如：
   ```json
   {"image_name": "my-image:latest"}
   ```
4. 点击“开始扫描”，任务进入队列

### 4.2 查看任务状态

- 任务列表展示状态（排队/运行/成功/失败）、耗时、风险数量
- 点击任意任务进入详情页

### 4.3 结果详情

- 漏洞按严重级别排序，显示文件路径、行号、描述、修复建议
- 支持导出 JSON 报告（按钮：导出）
- 若出现 Mock 数据（提示“工具未安装”），说明扫描工具缺失或参数不完整，请联系管理员

## 5. RASP 攻击事件

1. 菜单 → “攻击事件”
2. 支持按拦截状态、攻击类型、时间范围筛选
3. 点击“查看详情”可查看请求来源、报文、堆栈
4. 事件来源示例：
   - Path Traversal（拦截请求 `/api/chat-history/test-rasp-file?filename=/etc/passwd`）
   - 任意文件读取（IAST 漏洞扫描产生）

## 6. 仪表盘与报表

- 首页仪表盘展示项目数量、扫描次数、漏洞趋势、风险等级统计
- “报告”菜单可查看生成的历史报表（JSON 格式），后续版本将支持 PDF

## 7. 自动化集成

### 7.1 GitHub Actions

示例步骤：

```yaml
- name: Trigger USS Scan
  run: |
    curl -X POST "https://uss.example.com/api/scans" \
      -H "Authorization: Bearer ${{ secrets.USS_TOKEN }}" \
      -H "Content-Type: application/json" \
      -d '{"project_id":1,"scan_type":"sast"}'
```

### 7.2 Dependabot

- 在 GitHub 仓库启用 Dependabot，自动创建依赖升级 PR
- 配置 USS 平台在 PR 合并前执行 SCA 复核

## 8. 常见问题（FAQ）

| 场景 | 解决方案 |
| ---- | -------- |
| 上传后仍显示“未上传” | 清空浏览器缓存；确保后端 `uploaded_files/` 有文件；问题已在前端更新中修复 |
| 扫描结果为 0 | 检查日志；SCA 工具缺失时会有 Mock 提示；确认项目中存在依赖文件 |
| 容器扫描失败 | JSON 配置中补充 `image_name`；确认 Trivy 已安装 |
| RASP 事件无数据 | 确认 Agent 是否上线；触发模拟攻击；检查后台“主机管理”与 `MAVEN_OPTS` |
| 登录后立即跳回登录页 | 清空 localStorage，重新登录；确认后端 `SECRET_KEY` 未变更 |

## 9. 联系与支持

- GitHub Issues：提交 Bug/需求建议
- 安全团队邮箱：security-team@example.com
- 平台管理员：`openrasp / zzy100416`


