---
marp: true
paginate: true
style: |
  /* 全局：渐变绿色背景，白色文字，适配大屏投影 */
  section {
    background: linear-gradient(135deg, #00c26e 0%, #00ab63 32%, #009257 62%, #00784b 100%);
    color: #ffffff;
  }
  h1, h2, h3 { color: #ffffff; }
  a { color: #e2ffe9; }
  code { background: rgba(255,255,255,0.12); padding: .15em .35em; border-radius: 4px; }
  /* 可选的浅色版幻灯片：在某页加 `class: light` */
  section.light { background: #ffffff; color: #0a0a0a; }
  section.light h1, section.light h2, section.light h3 { color: #0a0a0a; }
---

# 统一安全扫描平台（USS）产品介绍（演示稿）

> 用途：可直接导入支持 Markdown 的演示工具（Typora + Marp / VSCode + Marp / Deckset），或复制到 PowerPoint，将每个一级标题作为一页幻灯片。

---

## 1. 封面
- 标题：统一安全扫描平台（USS）
- 副标题：SAST / SCA / 容器 / RASP 一体化 DevSecOps 平台
- 版本：V1.0（2025-11）
- 演示人：XXXX

---

## 2. 背景与痛点
- 工具割裂与信息孤岛：SAST、SCA、容器、RASP 分散，数据口径不一致
  - 人工收集与整合成本高，决策延迟
  - 不同工具扫描策略/阈值不统一，研发难以理解
- CI/CD 可用性不足：流水线中安全环节“时有时无”
  - 执行时间不可控，易被随意关闭
  - 结果回流到 PR/工单的闭环缺失
- 运行时缺口：仅“左移扫描”，没有“右护防御”
  - 真实攻击场景不感知，生产可观测性弱
- 本地化与合规诉求：内网/离线环境、高等级安全域
  - 需要可控、可移植的私有化方案

---

## 3. 目标与定位
- 平台目标：提供“扫描前置 + 运行时联动”的统一安全中台
  - 在一个门户内覆盖 SAST/SCA/容器/RASP
  - 打通 CI/CD 与运行时，提供风险全景图
- 目标用户：安全工程师、研发/技术负责人、DevOps、管理层
- 适配场景：本地化/隔离环境、数据敏感行业（金融/政企/能源）

---

## 4. 能力总览（功能矩阵）
- 项目管理
  - 支持仓库信息登记与 ZIP 上传；自动识别技术栈（package.json/pom.xml 等）
  - 上传后落地到 `uploaded_files/project_{id}`，前端回显“已上传”状态
- 扫描编排
  - SAST（Semgrep）：内置常用规则 + 自定义规则
  - SCA：Java(Dependency-Check)/Node(npm audit)/Python(pip-audit)
  - 容器：Trivy（CVE）+ Hadolint（规范）
  - RASP：OpenRASP 事件聚合，支持 app_id、时间范围查询
- 结果分析
  - 漏洞分级统计（CRITICAL→INFO）、修复建议、RAW 数据留存
  - 仪表盘：项目/任务/漏洞趋势、Top 文件/规则
- DevSecOps 集成
  - REST API、GitHub Actions 模板、Dependabot 协同
- 运行时联动
  - 自动登录获取 Cookie，POST `/v1/api/log/attack/search` 拉取事件

---

## 5. 技术架构
- 前端：React + Ant Design（仪表盘、任务、事件、报表）
- 后端：Flask + SQLAlchemy + ThreadPool（异步任务）
- 工具链集成：Semgrep / Dependency-Check / pip-audit / npm audit / Trivy / OpenRASP API
- 存储：PostgreSQL（扫描结果、任务、项目）；Redis（可选队列缓存）
- 部署：Docker Compose；Volume：`scan_results/`、`uploaded_files/`
- 安全：JWT 鉴权、容器隔离、最小权限运行

---

## 6. 关键功能（1）——扫描编排
- SAST（示例）
  - 规则来源：内置社区规则 + 组织自定义规则仓库
  - 典型风险：硬编码凭据、命令注入、未验证输入、弱加密
  - 产出：文件/行号/规则 ID/修复建议
- SCA
  - Maven：Dependency-Check；Node：`npm audit --json`；Python：`pip-audit`
  - 兼容策略：当主工具不可用时提供 Mock/降级提示，避免“卡死”
- 容器
  - Trivy：镜像级漏洞；Hadolint：Dockerfile 规范
  - 支持私有 Registry（后续可扩展认证）
- JSON 参数示例：`{"image_name":"your-image:tag"}`

---

## 7. 关键功能（2）——RASP 联动
- Agent 集成：支持在 Spring Boot 通过 `MAVEN_OPTS` 注入 `-javaagent`，YAML 统一配置 `cloud.*`
- API 适配：自动登录（用户名/密码 → RASP_AUTH_ID Cookie），调用 `/v1/api/log/attack/search`
- 场景：Path Traversal / 任意文件读取 / SQL 注入链路回溯（可扩展）
- 事件字段：`attack_type`、`intercept_state`、`stack_trace`、`client_ip`、`request_id`
- 主机管理 / 事件页截图（占位）：建议展示“enen 主机上线、状态正常”的页面

---

## 8. 关键功能（3）——结果与报表
- 分级聚合：CRITICAL/HIGH/MEDIUM/LOW/INFO（可配置映射）
- 漏洞详情：路径、行号、描述、建议、参考链接、原始 JSON 保留
- 趋势看板：近 30 天任务量、风险 TOP、规则命中趋势
- 导出与溯源：JSON 导出；后续 PDF/HTML；支持任务/项目维度检索

---

## 9. DevSecOps 集成
- GitHub Actions：
  ```yaml
  - name: Trigger USS Scan
    run: |
      curl -X POST "https://uss.example.com/api/scans" \
        -H "Authorization: Bearer ${{ secrets.USS_TOKEN }}" \
        -H "Content-Type: application/json" \
        -d '{"project_id":1,"scan_type":"sast"}'
  ```
- Dependabot：定期依赖升级 + 平台 SCA 复核
- REST API：`/api/projects`、`/api/scans`、`/api/rasp/events`

---

## 10. 部署与运维
- 部署：`docker-compose up -d --build`
- 目录：`scan_results/`（结果）、`uploaded_files/`（上传）
- 文档沉淀：Dependency-Check、Trivy、OpenRASP、MySQL 全覆盖（/docs）
- 常见问题：
  - 工具下载失败 → Dockerfile 备用镜像/手工包
  - 容器扫描失败 → JSON 缺少 `image_name`
  - RASP 不生效 → `MAVEN_OPTS` 注入 & YAML 缩进修正
  - MySQL 拒绝 → `mysql_native_password` & 容器 IP 连接

---

## 11. 竞争对比与差异化
- 对比：Snyk/Checkmarx/Aqua （SaaS/商业授权/规则库闭源）
- 我们的优势：本地化、离线可用、运行时闭环、成本可控、排障文档完善
- 短板与改进：增强报表（PDF）、消息通知、规则库自动更新、SLA/多租户

---

## 12. 成功案例 / 演示
- 项目：`chatbotAi` 集成 OpenRASP（主机名：enen）
- 演示脚本：
  1. 打开“主机管理”，确认主机在线 & 上次通信时间
  2. 执行 `curl http://localhost:9988/api/chat-history/test-rasp-file?filename=/etc/passwd`
  3. 刷新“攻击事件”，展示拦截记录与详情
- 截图占位：仪表盘/任务详情/RASP 事件

---

## 13. 路线图
- V1.1（短期）：报告 PDF/HTML、消息通知、规则库自动更新
- V1.2（中期）：多租户、SaaS 化试点、运营指标与 SLA
- V2.0（远期）：AI 规则推荐、修复工单闭环、威胁情报联动

---

## 14. 价值与收益
- 效率：一次接入多能力、统一门户、信息不再割裂
- 风险：开发左移 + 运行时右护，缩短发现到修复闭环
- 成本：开源工具 + 自研平台，TCO 显著下降

---

## 15. Q&A
- 文档与仓库地址：`/docs`、GitHub 链接
- 平台管理员与联系方式


