# 最终启动步骤 - MySQL已修复

## ✅ 已完成的修复

1. ✅ MySQL认证已修复（root用户使用mysql_native_password）
2. ✅ 使用容器IP连接成功（172.20.0.2）
3. ✅ 应用配置已更新为使用容器IP

## 启动应用（带OpenRASP）

```bash
cd ~/projects/bailianyingyong/chatbotAi

# 1. 停止旧进程（如果有）
pkill -f "spring-boot:run"
sleep 2

# 2. 设置OpenRASP（使用MAVEN_OPTS）
export MAVEN_OPTS="-javaagent:/home/enen/openrasp/rasp-2023-03-31/rasp/rasp.jar"
export RASP_APP_ID=zhinengtiyingyong
export RASP_BACKEND_URL=http://192.168.203.141:8086

# 3. 验证配置
echo "=== 配置检查 ==="
echo "MAVEN_OPTS: $MAVEN_OPTS"
echo "RASP_APP_ID: $RASP_APP_ID"
echo "MySQL URL: $(grep 'datasource.url' src/main/resources/application.properties | cut -d'=' -f2)"
echo ""

# 4. 启动应用
echo "=== 启动应用 ==="
mvn spring-boot:run
```

## 验证步骤

### 1. 验证OpenRASP已加载

启动后，检查日志应该显示：
```
[INFO] Attaching agents: [-javaagent:/home/enen/openrasp/rasp-2023-03-31/rasp/rasp.jar]
```

或者检查进程：
```bash
ps aux | grep java | grep javaagent
```

### 2. 验证MySQL连接成功

启动后，应该不再看到 `Access denied` 或 `Connection refused` 错误。

### 3. 验证应用启动成功

日志应该显示：
```
Tomcat started on port 9988 (http) with context path ''
Started ChatbotAiApplication
```

### 4. 在OpenRASP管理后台验证

1. 访问：`http://192.168.203.141:8086`
2. 登录（用户名：`openrasp`，密码：`zzy100416`）
3. 在"当前应用"下拉菜单中选择 `zhinengtiyingyong`
4. 查看是否有数据或应用状态

## 完整启动命令

```bash
cd ~/projects/bailianyingyong/chatbotAi

# 停止旧进程
pkill -f "spring-boot:run"
sleep 2

# 设置OpenRASP
export MAVEN_OPTS="-javaagent:/home/enen/openrasp/rasp-2023-03-31/rasp/rasp.jar"
export RASP_APP_ID=zhinengtiyingyong
export RASP_BACKEND_URL=http://192.168.203.141:8086

# 启动
mvn spring-boot:run
```

## 如果启动成功

应用启动后：
1. ✅ 应用运行在：`http://localhost:9988`
2. ✅ MySQL连接正常
3. ✅ OpenRASP Agent已加载
4. ✅ 在OpenRASP管理后台可以看到 `zhinengtiyingyong` 应用

## 下一步

1. 在统一安全扫描平台中同步RASP事件
2. 测试应用功能
3. 触发一些测试攻击，验证OpenRASP是否正常工作

