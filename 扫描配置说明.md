# 扫描配置说明

在"新建扫描任务"对话框中，**扫描配置（JSON格式）**字段根据不同的扫描类型需要填写不同的内容。

## 1. SAST - 静态代码扫描

**配置要求：** 通常不需要配置，可以为空或填写 `{}`

**示例：**
```json
{}
```

**说明：**
- SAST扫描会自动扫描项目目录
- 扫描路径由系统自动从项目配置中获取

---

## 2. SCA - 依赖漏洞扫描

**配置要求：** 通常不需要配置，可以为空或填写 `{}`

**示例：**
```json
{}
```

**说明：**
- SCA扫描会自动扫描项目目录中的依赖文件（如 `package.json`, `requirements.txt`, `pom.xml` 等）
- 扫描路径由系统自动从项目配置中获取

---

## 3. 容器镜像扫描

**配置要求：** **必须**填写镜像名称

**示例：**
```json
{
  "image_name": "nginx:latest"
}
```

**其他示例：**
```json
{
  "image_name": "python:3.11-slim"
}
```

```json
{
  "image_name": "node:18-alpine"
}
```

**说明：**
- `image_name`: 要扫描的Docker镜像名称（必需）
  - 格式：`<镜像名>:<标签>` 或 `<镜像名>`
  - 例如：`nginx:latest`, `ubuntu:20.04`, `redis`

---

## 4. RASP - 运行时安全扫描

**配置要求：** 需要指定应用ID，可选时间范围

**示例1：基本配置（只指定应用ID）**
```json
{
  "app_id": "my-app-001"
}
```

**示例2：完整配置（指定应用ID和时间范围）**
```json
{
  "app_id": "my-app-001",
  "start_time": "2025-01-01T00:00:00",
  "end_time": "2025-01-31T23:59:59"
}
```

**说明：**
- `app_id`: OpenRASP中的应用ID（必需）
  - 这是你在OpenRASP管理后台中注册的应用ID
- `start_time`: 开始时间（可选）
  - ISO 8601格式：`YYYY-MM-DDTHH:MM:SS`
  - 例如：`2025-01-01T00:00:00`
- `end_time`: 结束时间（可选）
  - ISO 8601格式：`YYYY-MM-DDTHH:MM:SS`
  - 例如：`2025-01-31T23:59:59`

**注意：**
- 如果不指定`app_id`，系统会尝试获取所有应用的事件
- 时间格式必须严格按照 ISO 8601 标准

---

## 快速参考表

| 扫描类型 | 配置字段 | 是否必需 | 示例 |
|---------|---------|---------|------|
| SAST | - | 否 | `{}` |
| SCA | - | 否 | `{}` |
| 容器扫描 | `image_name` | **是** | `{"image_name": "nginx:latest"}` |
| RASP | `app_id` | **是** | `{"app_id": "my-app-001"}` |
| RASP | `start_time` | 否 | `{"app_id": "my-app-001", "start_time": "2025-01-01T00:00:00"}` |
| RASP | `end_time` | 否 | `{"app_id": "my-app-001", "end_time": "2025-01-31T23:59:59"}` |

---

## 常见错误

### ❌ 错误示例1：JSON格式错误
```json
{
  image_name: "nginx:latest"  // 错误：属性名没有引号
}
```

### ✅ 正确格式
```json
{
  "image_name": "nginx:latest"  // 正确：属性名有引号
}
```

### ❌ 错误示例2：缺少必需字段
```json
{}  // 错误：容器扫描必须指定image_name
```

### ✅ 正确格式
```json
{
  "image_name": "nginx:latest"  // 正确：包含必需字段
}
```

---

## 提示

1. **JSON格式验证**：填写后可以先验证JSON格式是否正确
2. **可以为空**：对于SAST和SCA扫描，配置可以为空
3. **容器镜像**：确保镜像名称正确，系统会尝试拉取并扫描该镜像
4. **RASP应用ID**：确保应用ID与OpenRASP管理后台中的一致

